@model WFMPCP.Model.Web.NavigationView
@{
    Layout = null;
}

<ul class="nav nav-list">
   

@foreach( var parent in Model.Parent )
{
    var parentListClass = "";
    var children = Model.Children.Where( x => x.ParentID == parent.ID ).ToList();
    var toggleClass = "";
    //var active = "";
    //var parentName = module.Name;
    var currentRequestpath = Request.Url.LocalPath;

    if( parent.Route == currentRequestpath )
    { parentListClass = "active"; }

    if( children != null )
    {
        if( children.Count > 0 )
        {
            parentListClass = "";
            //parentListClass="open"; //TODO: Use this to load Navigation List in expanded mode.
            toggleClass = "dropdown-toggle";

            if( children != null )
            {
                if( children.Count > 0 )
                {
                    foreach( var child in children )
                    {
                        if( currentRequestpath == child.Route )
                        {
                            parentListClass = "active open";
                        }
                    }
                }
            }
        }
    }
    <li class="@parentListClass">
        @{ 
            var parentRoute = "#";
            if( @parent.Route.Trim() != "#")
            {
                var pRoute = @parent.Route.Trim().Split( '/' );
                parentRoute = Url.Action( pRoute[2], pRoute[1] );
            }
        }
        <a href="@parentRoute" class="@toggleClass">
            <i class="@parent.MenuIcon"></i>
            <span class="menu-text"> @parent.Name </span>
        </a>

        @if( children != null )
        {
            if( children.Count > 0 )
            {
                <b class="arrow"></b>
                <ul class="submenu">
                    @foreach( var child in children )
                    {
                        var childLiClass = "";
                        if( currentRequestpath == child.Route )
                        {
                            childLiClass = "active";
                        }

                        var childRoute = "#";
                        if(child.Route != "#")
                        {
                            var cRoute = child.Route.Trim().Split( '/' );
                            childRoute = Url.Action( cRoute[2], cRoute[1] );
                        }

                        <li class="@childLiClass">
                            <a href="@childRoute">
                                <i class="menu-icon fa fa-caret-right"></i>
                                @child.Name
                            </a>

                            <b class="arrow"></b>
                        </li>
                    }                    
                </ul>
            }
        }
    </li>

}

    @*<li class="active open">
        <a href="#" class="dropdown-toggle">
            <i class="menu-icon fa fa-tag"></i>
            <span class="menu-text"> More Pages </span>

            <b class="arrow fa fa-angle-down"></b>
        </a>

        <b class="arrow"></b>

        <ul class="submenu">
            <li>
                <a href="profile.html">
                    <i class="menu-icon fa fa-caret-right"></i>
                    User Profile
                </a>

                <b class="arrow"></b>
            </li>

            <li class="">
                <a href="inbox.html">
                    <i class="menu-icon fa fa-caret-right"></i>
                    Inbox
                </a>

                <b class="arrow"></b>
            </li>

            <li class="">
                <a href="pricing.html">
                    <i class="menu-icon fa fa-caret-right"></i>
                    Pricing Tables
                </a>

                <b class="arrow"></b>
            </li>

            <li class="">
                <a href="invoice.html">
                    <i class="menu-icon fa fa-caret-right"></i>
                    Invoice
                </a>

                <b class="arrow"></b>
            </li>

            <li class="">
                <a href="timeline.html">
                    <i class="menu-icon fa fa-caret-right"></i>
                    Timeline
                </a>

                <b class="arrow"></b>
            </li>

            <li class="">
                <a href="search.html">
                    <i class="menu-icon fa fa-caret-right"></i>
                    Search Results
                </a>

                <b class="arrow"></b>
            </li>

            <li class="">
                <a href="email.html">
                    <i class="menu-icon fa fa-caret-right"></i>
                    Email Templates
                </a>

                <b class="arrow"></b>
            </li>

            <li class="">
                <a href="login.html">
                    <i class="menu-icon fa fa-caret-right"></i>
                    Login &amp; Register
                </a>

                <b class="arrow"></b>
            </li>
        </ul>
    </li>
    <li class="">
        <a href="widgets.html">
            <i class="menu-icon fa fa-list-alt"></i>
            <span class="menu-text"> Widgets </span>
        </a>

        <b class="arrow"></b>
    </li>*@
    @*<li class="">
        <a href="#" class="dropdown-toggle">
            <i class="menu-icon fa fa-file-o"></i>

            <span class="menu-text">
                Other Pages

                <span class="badge badge-primary">5</span>
            </span>

            <b class="arrow fa fa-angle-down"></b>
        </a>

        <b class="arrow"></b>

        <ul class="submenu">
            <li class="">
                <a href="faq.html">
                    <i class="menu-icon fa fa-caret-right"></i>
                    FAQ
                </a>

                <b class="arrow"></b>
            </li>

            <li class="">
                <a href="error-404.html">
                    <i class="menu-icon fa fa-caret-right"></i>
                    Error 404
                </a>

                <b class="arrow"></b>
            </li>

            <li class="">
                <a href="error-500.html">
                    <i class="menu-icon fa fa-caret-right"></i>
                    Error 500
                </a>

                <b class="arrow"></b>
            </li>

            <li class="">
                <a href="grid.html">
                    <i class="menu-icon fa fa-caret-right"></i>
                    Grid
                </a>

                <b class="arrow"></b>
            </li>

            <li class="">
                <a href="blank.html">
                    <i class="menu-icon fa fa-caret-right"></i>
                    Blank Page
                </a>

                <b class="arrow"></b>
            </li>
        </ul>
    </li>*@
</ul>