@model WFMPCP.Model.Web.AHCViews

@{ var noData = false;
    var dates = string.Empty;
}
@*@if( Model.IsLoadDataGrid )
{
<table id="tblPivotTotal" class="table  table-bordered table-hover ">
    <thead>
        <tr>

            @if( Model.IsLoadDataGrid )
            {
                try
                {
                    foreach( var row in Model.PivotHiringTotal.FirstOrDefault() )
                    {
                        if( row.Key == "Datapoint" )
                        {
                            <th style="text-align:center;">@row.Key</th>
                        }
                        else
                        {
                            <th style="text-align:center;"><a id="ahref" href="#">@row.Key</a></th>
                        }
                    }
                }
                catch
                {
                    noData = true;
                    <th>&nbsp;</th>
                }

            }
            else
            {
                <th>&nbsp;</th>
            }
        </tr>

    </thead>

    <tbody>
        @try
        {
            if( Model.IsLoadDataGrid )
            {
                List<string> colValue = new List<string>();
                foreach( var row in Model.PivotHiringTotal )
                {


                    <tr>
                        @foreach( var column in row )
                        {
                            string style = "text-align:center;";

                            <td style="@style">@column.Value</td>
                        }
                    </tr>
                }

            }
        }
        catch( Exception ex )
        {
            <tr>
                <td style="font-weight:bold;color:red;">Data is not available.</td>
            </tr>
        }

        @if( noData )
            {
            <tr>
                <td style="font-weight:bold;color:red;">Data is not available.</td>
            </tr>
        }
    </tbody>
</table>
<br />
}*@
    <!---------------------------------------------------------------->
    <table id="tblPivotHeader" class="table  table-bordered table-hover ">
        <thead>
            <tr>
           
                @if( Model.IsLoadDataGrid )
            {
                try
                {
                    foreach( var row in Model.Pivot.FirstOrDefault() )
                    {
                        if( row.Key != "LobID"  && row.Key != "DatapointID" )
                        {
                            if( row.Key == "Lob" )
                            {
                                <th style="text-align:center;">Line of Business</th>
                            }
                            else if( row.Key == "Datapoint" )
                            {
                                <th style="text-align:center;">@row.Key</th>
                            }
                            else
                            {
                                var date = Convert.ToDateTime( row.Key ).ToString( "MMM dd, yyyy" );
                                <th style="text-align:center;"><a id="ahref" href="#">@date</a></th>
                            }
                        }
                    }
                }
                catch
                {
                    noData = true;
            <th>&nbsp;</th>
                }

            }
            else
            {
            <th>&nbsp;</th>
            }
            </tr>

        </thead>
        <tbody>
            @try
        {
            if( Model.IsLoadDataGrid )
            {
                List<string> colValue = new List<string>();
                foreach( var row in Model.Pivot )
                {


        <tr>
            @{long lobID = 0;
                string dtpointid = "";}
            @foreach( var column in row )
            {
                string style = "text-align:center;";

                if( column.Key.Trim() == "LobID" )
                {
                    lobID = Convert.ToInt64( column.Value );
                }
                try
                {
                    Convert.ToInt64( column.Value.ToString() );
                }
                catch { style += "font-weight:bold;"; }

                if( column.Key.Trim() == "DatapointID" || column.Key.Trim() == "LobID" )
                {
                    style += "display:none;";
                }
                if( column.Key.Trim() == "DatapointID" )
                {
                    dtpointid = column.Value.ToString();
                }

                if( column.Key.Trim() == "Lob" )
                {
                    string colVal = Convert.ToString( lobID ).Trim();
                    colValue.Add( colVal );

                    int segmentCount = colValue.Where( x => x == colVal ).Count();
                    if( segmentCount == 1 )
                    {
                        int rowCount = Model.Pivot.Where( x => x.Values.Contains( lobID ) ).Count();
                        if( rowCount > 34 )
                        {
                            rowCount = 34;
                        }
                        <td style="@style" rowspan="@rowCount.ToString()">
                            @column.Value 
                        </td>
                                }
                            }

                            if( column.Key.Trim() != "DatapointID" && column.Key.Trim() != "LobID" && column.Key.Trim() != "Lob" && column.Key.Trim() != "Datapoint" )
                            {
                                style = "text-align:center;";
                                try
                                {
                                    var numValue = Convert.ToDecimal( @column.Value.ToString().Replace( "%", "" ).Trim() );
                                    if( numValue < 0 )
                                    {
                                        style += "font-weight:bold;color:Red;";
                                    }
                                    else if( numValue == 0 )
                                    {
                                        style += "font-weight:bold;";
                                    }
                                }
                                catch { }
                        <td style="@style">@column.Value</td>
                            }
                            else if( column.Key.Trim() == "Datapoint" )
                            {
                        <td style="@style">@column.Value</td>
                            }

                        }
        </tr>
                                }

                            }
                            else
                            {
        <tr>
            <td style="font-weight:bold;color:red;">Data is not available.</td>
        </tr>
                }
            }
        catch( Exception ex)
        {
        <tr>
            <td style="font-weight:bold;color:red;">Data is not available.</td>
        </tr>
        }

            @if( noData )
            {
        <tr>
            <td style="font-weight:bold;color:red;">Data is not available.</td>
        </tr>
        }
        </tbody>
    </table>

    <!---------------------------------------------------------------->
